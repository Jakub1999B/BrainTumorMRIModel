# -*- coding: utf-8 -*-
"""models.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1AEXYsLIBLRMzgly0lcsJRkxc-_6m_fZo
"""

import os
import sys
sys.path.append("/content/drive/MyDrive/BrainTumorMRIModel")
import numpy as np
import pandas as pd
import tensorflow as tf
import matplotlib.pyplot as plt
from tensorflow import keras
from skimage import color
from skimage import io
import sklearn
from tqdm import tqdm
import cv2
import seaborn as sns
from keras import layers
from sklearn.model_selection import train_test_split
from tensorflow.keras.preprocessing.image import ImageDataGenerator
from tensorflow.keras import datasets, layers, models
from sklearn.metrics import confusion_matrix
from sklearn.metrics import classification_report
import argparse
from tensorflow.keras.utils import to_categorical
from imutils import paths
from tensorflow.keras.optimizers import SGD
from keras import Sequential

class BrainTumorMRIModel4(tf.keras.Model):

  def __init__(self):
    super(BrainTumorMRIModel4, self).__init__()
    self.conv1 = tf.keras.layers.Conv2D(filters=32, kernel_size=(3, 3), strides=(1, 1), padding='same', activation='relu')
    self.maxPool1 = tf.keras.layers.MaxPool2D(pool_size=(2, 2))
    self.conv2 = tf.keras.layers.Conv2D(filters=64, kernel_size=(3, 3), strides=(1, 1), padding='same', activation='relu')
    self.maxPool2 = tf.keras.layers.MaxPool2D(pool_size=(2, 2))
    self.conv3 = tf.keras.layers.Conv2D(filters=128, kernel_size=(3, 3), strides=(1, 1), padding='same', activation='relu')
    self.maxPool3 = tf.keras.layers.MaxPool2D(pool_size=(2, 2))
    self.conv4 = tf.keras.layers.Conv2D(filters=128, kernel_size=(3, 3), strides=(1, 1), padding='same', activation='relu')
    self.maxPool4 = tf.keras.layers.MaxPool2D(pool_size=(2, 2))
    self.flat = tf.keras.layers.Flatten()
    self.den1 = tf.keras.layers.Dense(512, activation = 'relu')
    self.den2 = tf.keras.layers.Dense(4, activation='softmax')

  def call(self, x, training=True):    #used for training
    x = self.conv1(x)
    x = self.maxPool1(x)
    x = self.conv2(x)
    x = self.maxPool2(x)
    x = self.conv3(x)
    x = self.maxPool3(x)
    x = self.conv4(x)
    x = self.maxPool4(x)
    x = self.flat(x)
    x = self.den1(x)
    x = self.den2(x)

    return x

  def get_embedding(self, x):   #used for latent space visualization
    x = self.conv1(x)
    x = self.maxPool1(x)
    x = self.conv2(x)
    x = self.maxPool2(x)
    x = self.conv3(x)
    x = self.maxPool3(x)
    x = self.conv4(x)
    x = self.maxPool4(x)
    x = self.flat(x)
    x = self.den1(x)

    return x

class BrainTumorMRIModel6(tf.keras.Model):

  def __init__(self):
    super(BrainTumorMRIModel6, self).__init__()
    self.conv1 = tf.keras.layers.Conv2D(filters=32, kernel_size=(3, 3), strides=(1, 1), padding='same', activation='relu')
    self.maxPool1 = tf.keras.layers.MaxPool2D(pool_size=(2, 2))
    self.conv2 = tf.keras.layers.Conv2D(filters=32, kernel_size=(3, 3), strides=(1, 1), padding='same', activation='relu')
    self.maxPool2 = tf.keras.layers.MaxPool2D(pool_size=(2, 2))
    self.conv3 = tf.keras.layers.Conv2D(filters=64, kernel_size=(3, 3), strides=(1, 1), padding='same', activation='relu')
    self.maxPool3 = tf.keras.layers.MaxPool2D(pool_size=(2, 2))
    self.conv4 = tf.keras.layers.Conv2D(filters=64, kernel_size=(3, 3), strides=(1, 1), padding='same', activation='relu')
    self.maxPool4 = tf.keras.layers.MaxPool2D(pool_size=(2, 2))
    self.conv5 = tf.keras.layers.Conv2D(filters=128, kernel_size=(3, 3), strides=(1, 1), padding='same', activation='relu')
    self.maxPool5 = tf.keras.layers.MaxPool2D(pool_size=(2, 2))
    self.conv6 = tf.keras.layers.Conv2D(filters=128, kernel_size=(3, 3), strides=(1, 1), padding='same', activation='relu')
    self.maxPool6 = tf.keras.layers.MaxPool2D(pool_size=(2, 2))
    self.flat = tf.keras.layers.Flatten()
    self.den1 = tf.keras.layers.Dense(512, activation = 'relu')
    self.den2 = tf.keras.layers.Dense(4, activation='softmax')

  def call(self, x, training=True):    #used for training
    x = self.conv1(x)
    x = self.maxPool1(x)
    x = self.conv2(x)
    x = self.maxPool2(x)
    x = self.conv3(x)
    x = self.maxPool3(x)
    x = self.conv4(x)
    x = self.maxPool4(x)
    x = self.conv5(x)
    x = self.maxPool5(x)
    x = self.conv6(x)
    x = self.maxPool6(x)
    x = self.flat(x)
    x = self.den1(x)
    x = self.den2(x)

    return x

  def get_embedding(self, x):   #used for latent space visualization
    x = self.conv1(x)
    x = self.maxPool1(x)
    x = self.conv2(x)
    x = self.maxPool2(x)
    x = self.conv3(x)
    x = self.maxPool3(x)
    x = self.conv4(x)
    x = self.maxPool4(x)
    x = self.conv5(x)
    x = self.maxPool5(x)
    x = self.conv6(x)
    x = self.maxPool6(x)
    x = self.flat(x)
    x = self.den1(x)

    return x