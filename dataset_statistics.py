# -*- coding: utf-8 -*-
"""dataset_statistics.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1T6k52WSGa3LdZX7VAE1St9_pe7xYvpRm
"""

import os
import sys
import numpy as np
import pandas as pd
import tensorflow as tf
import matplotlib.pyplot as plt
from tensorflow import keras
from skimage import color
from skimage import io
import sklearn
from tqdm import tqdm
import cv2
import seaborn as sns
from keras import layers
from sklearn.model_selection import train_test_split
from tensorflow.keras.preprocessing.image import ImageDataGenerator
from tensorflow.keras import datasets, layers, models
from sklearn.metrics import confusion_matrix
from sklearn.metrics import classification_report
import argparse
from tensorflow.keras.utils import to_categorical
from imutils import paths
from tensorflow.keras.optimizers import SGD
from keras import Sequential

# COUNTING CLASSES IN DFIFFERENT DATASETS

def class_counter(dataset):
  dataset = np.concatenate([y for x, y in dataset], axis=0)
  dataset = dataset.astype("uint8")

  classes = []
  for i in dataset:
    clas = np.where(i == 1)
    classes.append(clas[0][0])

  glioma = 0
  meningioma = 0
  no = 0
  pituitary = 0

  for i in classes:
    if i == 0:
      glioma += 1
    elif i == 1:
      meningioma += 1
    elif i == 2:
      no += 1
    else:
      pituitary += 1

  return glioma, meningioma, no, pituitary

def plot_classes_count(figsize, fontsize, labels, glioma_train_count, meningioma_train_count, no_train_count, pituitary_train_count, glioma_val_count, meningioma_val_count, no_val_count, pituitary_val_count, glioma_test_count, meningioma_test_count, no_test_count, pituitary_test_count):
  plt.rcParams.update({'font.size': fontsize})
  plt.rcParams['font.family'] = 'serif'
  plt.rcParams['font.serif'] = ['Times New Roman'] + plt.rcParams['font.serif']
  plt.figure(figsize=figsize, dpi=300)
  plt.subplot(3,1,1)
  plt.bar(labels, [glioma_train_count, meningioma_train_count, no_train_count, pituitary_train_count], color=[	[0.482, 0.603, 0.937], [0.937, 0.882, 0.482], [0.937, 0.509, 0.482], [0.682, 0.870, 0.568]], zorder=3)
  plt.title('Train dataset classes count', fontsize = 26)
  plt.xlabel('class', fontsize = 22)
  plt.ylabel('count', fontsize = 22)
  plt.ylim((0,800))
  plt.grid(True, zorder=0)
  plt.subplot(3,1,2)
  plt.bar(labels, [glioma_val_count, meningioma_val_count, no_val_count, pituitary_val_count], color=[[0.482, 0.603, 0.937], [0.937, 0.882, 0.482], [0.937, 0.509, 0.482], [0.682, 0.870, 0.568]], zorder=3)
  plt.title('Validation dataset classes count', fontsize = 26)
  plt.xlabel('class', fontsize = 22)
  plt.ylabel('count', fontsize = 22)
  plt.ylim((0,800))
  plt.grid(True, zorder=0)
  plt.subplot(3,1,3)
  plt.bar(labels, [glioma_test_count, meningioma_test_count, no_test_count, pituitary_test_count], color=[[0.482, 0.603, 0.937], [0.937, 0.882, 0.482], [0.937, 0.509, 0.482], [0.682, 0.870, 0.568]], zorder=3)
  plt.title('Test dataset classes count', fontsize = 26)
  plt.xlabel('class', fontsize = 22)
  plt.ylabel('count', fontsize = 22)
  plt.ylim((0,800))
  plt.grid(True, zorder=0)
  plt.savefig('/content/drive/MyDrive/liczebnosc.svg', format='svg', dpi=300)
  plt.show()

def dataframe_classes_count(labels, glioma_train_count, meningioma_train_count, no_train_count, pituitary_train_count, glioma_val_count, meningioma_val_count, no_val_count, pituitary_val_count, glioma_test_count, meningioma_test_count, no_test_count, pituitary_test_count):
  data = {'Train dataset': [glioma_train_count, meningioma_train_count, no_train_count, pituitary_train_count],
        'Validation dataset': [glioma_val_count, meningioma_val_count, no_val_count, pituitary_val_count],
        'Test dataset': [glioma_test_count, meningioma_test_count, no_test_count, pituitary_test_count]
        }
  df = pd.DataFrame(data, index=labels)
  print(df)